{% extends "base.html" %}
{% load static %}
{% block content %}
<!--<link href="{% static 'css/custom.css' %}" rel='stylesheet'>-->
<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<style>
  table, td, th {
    text-align: center;
    padding-left: 10px;
    border: 1px solid black;
    font-size: 20px;
  }
  p{
    font-size: 12px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
  }
  
  th {
    background: aliceblue;
  }

  td {
    justify-content: center;
    align-items: center;
    height: 30px;
    font-size: 12px;
  }

  .search-container {
    margin-left: 35px;
    margin-top: 40px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .search-container input[type="text"] {
    padding: 5px;
    font-size: 14px;
    width: 125px;
    border: 1px solid rgb(93, 93, 93);
  }

  .search-container button {
    padding: 6px 12px;
    font-size: 14px;
    background-color: #007bff;
    color: white;
    border: none;
    cursor: pointer;
  }
  .content-container {
    background-color: antiquewhite;
    border: 3px solid #007a9b;
    padding: 10px;
    text-align: center;
    width: 60%;
    max-height: 80vh;
    overflow-y: auto;
  }
  .search-container button:hover {
    background-color: #0056b3;
  }

  .center {
    margin: auto;
    border: 3px solid #007a9b;
    padding: 10px;
    text-align: center;
    background-color: antiquewhite !important;
    height: 65vh;
    overflow-y: scroll;
  }
  .cen {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
  }
  .left {
    text-align: left;
  }

  .btn.btn-sm, .btn-group-sm > .btn {
    /* font-size: -0.125rem; */
    /* padding: -2.5rem -3.25rem; */
    border-radius: 4px;
    background-color: white;
    color: #0453bb;
    border: none;
}

</style>



<div style="background-color: rgb(255, 255, 255); width: 95%; margin: 20px; height: 86vh;">
  <div class="group-data-[sidebar-size=lg]:ltr:md:ml-vertical-menu group-data-[sidebar-size=lg]:rtl:md:mr-vertical-menu group-data-[sidebar-size=md]:ltr:ml-vertical-menu-md group-data-[sidebar-size=md]:rtl:mr-vertical-menu-md group-data-[sidebar-size=sm]:ltr:ml-vertical-menu-sm group-data-[sidebar-size=sm]:rtl:mr-vertical-menu-sm pt-[calc(theme('spacing.header')_*_1)] pb-[calc(theme('spacing.header')_*_0.8)] px-4 group-data-[navbar=bordered]:pt-[calc(theme('spacing.header')_*_1.3)] group-data-[navbar=hidden]:pt-0 group-data-[layout=horizontal]:mx-auto group-data-[layout=horizontal]:max-w-screen-2xl group-data-[layout=horizontal]:px-0 group-data-[layout=horizontal]:group-data-[sidebar-size=lg]:ltr:md:ml-auto group-data-[layout=horizontal]:group-data-[sidebar-size=lg]:rtl:md:mr-auto group-data-[layout=horizontal]:md:pt-[calc(theme('spacing.header')_*_1.6)] group-data-[layout=horizontal]:px-3 group-data-[layout=horizontal]:group-data-[navbar=hidden]:pt-[calc(theme('spacing.header')_*_0.9)]">
    <div class="container-fluid group-data-[content=boxed]:max-w-boxed mx-auto">
  
  <div class="py-3"></div>
    <!-- <h2>Account Group Table</h2> -->
    <div class="center">
      <div class="cen" style="display: flex; gap: 10px; margin-bottom: 50px;">
        <h2>Voucher Configuration List</h2>  
  
      </div>
      
  <table id="account-table">
    <tr>
      <th class="left">Category </th>
      <th class="left">Series</th>
      <th>Serial No</th>
      <th>Action</th>
    </tr> 
  
    {% for vc in voucherconfiguration %}
    {# Only display rows where NType is 'C' #}
    <tr style="background-color: rgb(255, 255, 255); color: black; margin-top: 10px;">
      <td class="left"><p>{{ vc.category }}</p></td>
      <td class="left"><p>{{ vc.series }}</p></td> 
      <td><p>{{ vc.serial_no }}</p></td>
<td>
    <!-- Edit button with icon -->
    <a href="{% url 'main:voucher_update' vc.id %}" class="btn btn-sm btn-primary" title="Edit">
        <i class="fas fa-edit"></i>
    </a>

    {% if vc.id %}
        <!-- Delete button with icon -->
        <a href="{% url 'main:voucher_delete' vc.id %}" 
           class="btn btn-sm btn-danger delete-btn" 
           title="Delete">
            <i class="fas fa-trash-alt"></i>
        </a>
    {% endif %}
</td>

<!-- Make sure Font Awesome is loaded -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    </tr>
   
    {% endfor %}
  </table>
  </div>
  </div>
  </div>
</div>



<script>
    //script for deletion
document.addEventListener('DOMContentLoaded', function () {
    const deleteBtn = document.querySelector('.delete-btn');

    if (deleteBtn) {
        deleteBtn.addEventListener('click', function (e) {
            e.preventDefault();  // Prevent immediate navigation

            Swal.fire({
                title: "Are you sure?",
                text: "This action cannot be undone!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#d33",
                confirmButtonText: "Yes, delete it!"
            }).then((result) => {
                if (result.isConfirmed) {
                    // Show success message then redirect
                    Swal.fire({
                        title: "Deleted!",
                        text: "Resident record will be deleted.",
                        icon: "success",
                        timer: 1500,
                        showConfirmButton: false
                    });

                    // Delay a little so success message can be seen
                    setTimeout(() => {
                        window.location.href = deleteBtn.href;
                    }, 1600);
                }
            });
        });
    }
});
</script>







<script>
  
  $(function() {
    $("#date-from").datepicker({ dateFormat: "dd-mm-yy" });
    $("#date-to").datepicker({ dateFormat: "dd-mm-yy" });
    setDefaultDates();
  });

  function setDefaultDates() {
    const today = new Date();
    const formattedDate = `${String(today.getDate()).padStart(2, '0')}-${String(today.getMonth() + 1).padStart(2, '0')}-${today.getFullYear()}`;
    document.getElementById('date-from').value = formattedDate;
    document.getElementById('date-to').value = formattedDate;
  }

  function filterTable() {
    const serialNoCheckbox = document.getElementById("serial-no-checkbox").checked;
    const dateCheckbox = document.getElementById("date-checkbox").checked;
    const serialNoInput = document.getElementById("serial-no").value.toUpperCase();
    const dateFromInput = document.getElementById("date-from").value;
    const dateToInput = document.getElementById("date-to").value;
    const table = document.getElementById("account-table");
    const tr = table.getElementsByTagName("tr");

    for (let i = 1; i < tr.length; i++) {
      let serialNoTd = tr[i].getElementsByTagName("td")[1];
      let ndateTd = tr[i].getElementsByTagName("td")[2];

      if (serialNoTd && ndateTd) {
        const serialNoValue = serialNoTd.textContent || serialNoTd.innerText;
        const ndateValue = ndateTd.textContent || ndateTd.innerText;

        const [day, month, year] = ndateValue.split('/');
        const ndate = new Date(`${year}-${month}-${day}`);

        let displayRow = true;

        if (serialNoCheckbox && serialNoValue.toUpperCase().indexOf(serialNoInput) === -1) {
          displayRow = false;
        }

        if (dateCheckbox) {
          if (dateFromInput) {
            const [dayFrom, monthFrom, yearFrom] = dateFromInput.split('-');
            const dateFrom = new Date(`${yearFrom}-${monthFrom}-${dayFrom}`);
            if (ndate < dateFrom) {
              displayRow = false;
            }
          }

          if (dateToInput) {
            const [dayTo, monthTo, yearTo] = dateToInput.split('-');
            const dateTo = new Date(`${yearTo}-${monthTo}-${dayTo}`);
            if (ndate > dateTo) {
              displayRow = false;
            }
          }
        }

        tr[i].style.display = displayRow ? "" : "none";
      }
    }
  }

  function toggleInput(...inputIds) {
    inputIds.forEach(id => {
      const input = document.getElementById(id);
      input.disabled = !input.disabled;
      if (input.disabled) {
        input.value = '';
      }
    });
  }
</script>

{% endblock %}
