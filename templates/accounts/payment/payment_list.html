{% extends "base.html" %}
{% load static %}
{% block content %}

<style>
/* BODY & GENERAL STYLING */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #ffffffff;
    color: #333;
}

/* CONTAINER */
.center {
    {% comment %} margin: 40px auto; {% endcomment %}
    border-radius: 4px;
    padding: 20px;
    background-color: antiquewhite;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    max-width: 100%;
    height: 85vh;
    {% comment %} max-height:82vh {% endcomment %}
    overflow-y: scroll;
}

/* SEARCH BOXES */
.search-container {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
}

.center::-webkit-scrollbar {
    height: 6px;
}

.center::-webkit-scrollbar-thumb {
    background-color: #ccc;
    border-radius: 10px;
}
 .center::-webkit-scrollbar-track {
    background-color: #f9f9f9;
}

.container_box:hover {
    transform: translateY(-5px);
}

.search-container input[type="text"] {
    {% comment %} padding: 8px 10px; {% endcomment %}
    font-size: 14px;
    border: 1px solid #ccc;
    {% comment %} border-radius: 5px; {% endcomment %}
    transition: 0.3s;
}

.search-container input[type="text"]:focus {
    border-color: #007bff;
    box-shadow: 0 0 5px rgba(0,123,255,0.3);
    outline: none;
}

.search-container button {
    padding: 2px 5px;
    font-size: 14px;
    background-color: #007bff;
    color: white;
    border: none;
    {% comment %} border-radius: 5px; {% endcomment %}
    cursor: pointer;
    transition: 0.3s;
}

.search-container button:hover {
    background-color: #0056b3;
}

/* CHECKBOX LABEL */
.search-container label {
    font-size: 14px;
    margin-right: 5px;
}

/* TABLE STYLING */
#account-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 14px;
}

#account-table thead {
    background-color: #989898;
    color: white;
    font-weight: 600;
}

#account-table th, #account-table td {
    {% comment %} padding: 12px 10px; {% endcomment %}
    text-align: center;
    border-bottom: 1px solid #e0e0e0;
}

#account-table tbody tr:nth-child(even) {
    background-color: #f9f9f9;
}

#account-table tbody tr:hover {
    background-color: #e6f2ff;
    transition: 0.3s;
}

/* RESPONSIVE TABLE */
@media (max-width: 768px) {
    .search-container {
        flex-direction: column;
        align-items: flex-start;
    }

    .search-container input[type="text"] {
        width: 100%;
    }

    #account-table th, #account-table td {
        padding: 8px 5px;
        font-size: 12px;
    }

    .center {
        padding: 15px;
    }
}
</style>
<div style="background-color:;">
  <div class="group-data-[sidebar-size=lg]:ltr:md:ml-vertical-menu group-data-[sidebar-size=lg]:rtl:md:mr-vertical-menu group-data-[sidebar-size=md]:ltr:ml-vertical-menu-md group-data-[sidebar-size=md]:rtl:mr-vertical-menu-md group-data-[sidebar-size=sm]:ltr:ml-vertical-menu-sm group-data-[sidebar-size=sm]:rtl:mr-vertical-menu-sm pt-[calc(theme('spacing.header')_*_1)] pb-[calc(theme('spacing.header')_*_0.8)] px-4 group-data-[navbar=bordered]:pt-[calc(theme('spacing.header')_*_1.3)] group-data-[navbar=hidden]:pt-0 group-data-[layout=horizontal]:mx-auto group-data-[layout=horizontal]:max-w-screen-2xl group-data-[layout=horizontal]:px-0 group-data-[layout=horizontal]:group-data-[sidebar-size=lg]:ltr:md:ml-auto group-data-[layout=horizontal]:group-data-[sidebar-size=lg]:rtl:md:mr-auto group-data-[layout=horizontal]:md:pt-[calc(theme('spacing.header')_*_1.6)] group-data-[layout=horizontal]:px-3 group-data-[layout=horizontal]:group-data-[navbar=hidden]:pt-[calc(theme('spacing.header')_*_0.9)]">
    <div class="container-fluid group-data-[content=boxed]:max-w-boxed mx-auto">
  
  <div class="py-3"></div>
    <!-- <h2>Account Group Table</h2> -->
    <div class="center">
      <div style="display: flex; gap: 10px; margin-bottom: 20px;">
        <div class="search-container">
          <input type="checkbox" id="serial-no-checkbox" onclick="toggleInput('serial-no')">
          <label for="serial-no">Serial No:</label>
          <input type="text" id="serial-no" name="serial-no" disabled>
          <button type="button" onclick="filterTable()">Search</button>
        </div>
        <div class="search-container">
          <input type="checkbox" id="date-checkbox" onclick="toggleInput('date-from', 'date-to')">
          <label for="date-from">Date From:</label>
          <input type="text" id="date-from" name="date-from" disabled>
          <label for="date-to">Date To:</label>
          <input type="text" id="date-to" name="date-to" disabled>
          <button type="button" onclick="filterTable()">Search</button>
        </div>
      </div>
      
  <table id="account-table">
    <tr>
      <th>Series</th>
      <th>Serial No</th>
      <th>Date</th>
      <th>Account Code</th>
      <th>Narration</th>
      <th>CStatus</th>
      <th>NType</th>
      <th>Amount</th>
      <th>VAmount</th>
      <!-- 
      <th>UserId</th>
      <th>CoId</th>
      <th>BrId</th>
      <th>FYCode</th>
      -->
    </tr> 
  
    {% for voucher in vouchers %}
    {# Only display rows where NType is 'C' #}
    <tr style="background-color: rgb(255, 255, 255); color: black; margin-top: 10px;">
      <td>{{ voucher.Series }}</td>
      <td>{{ voucher.VoucherNo }}</td>
      <td>{{ voucher.Vdate|date:"d/m/Y" }}</td>
      <td>{{ voucher.Accountcode }}</td>
      <td>{{ voucher.Narration }}</td>
      <td>{{ voucher.CStatus }}</td>
      <td>{{ voucher.VType }}</td>
      <td>{{ voucher.payment }}</td>
      <td>{{ voucher.VAmount }}</td>

    </tr>
   
    {% endfor %}
  </table>
  </div>
  </div>
  </div>
</div>


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

<script>
  $(function() {
    $("#date-from").datepicker({ dateFormat: "dd-mm-yy" });
    $("#date-to").datepicker({ dateFormat: "dd-mm-yy" });
    setDefaultDates();
  });

  function setDefaultDates() {
    const today = new Date();
    const formattedDate = `${String(today.getDate()).padStart(2, '0')}-${String(today.getMonth() + 1).padStart(2, '0')}-${today.getFullYear()}`;
    document.getElementById('date-from').value = formattedDate;
    document.getElementById('date-to').value = formattedDate;
  }

  function filterTable() {
    const serialNoCheckbox = document.getElementById("serial-no-checkbox").checked;
    const dateCheckbox = document.getElementById("date-checkbox").checked;
    const serialNoInput = document.getElementById("serial-no").value.toUpperCase();
    const dateFromInput = document.getElementById("date-from").value;
    const dateToInput = document.getElementById("date-to").value;
    const table = document.getElementById("account-table");
    const tr = table.getElementsByTagName("tr");

    for (let i = 1; i < tr.length; i++) {
      let serialNoTd = tr[i].getElementsByTagName("td")[1];
      let ndateTd = tr[i].getElementsByTagName("td")[2];

      if (serialNoTd && ndateTd) {
        const serialNoValue = serialNoTd.textContent || serialNoTd.innerText;
        const ndateValue = ndateTd.textContent || ndateTd.innerText;

        const [day, month, year] = ndateValue.split('/');
        const ndate = new Date(`${year}-${month}-${day}`);

        let displayRow = true;

        if (serialNoCheckbox && serialNoValue.toUpperCase().indexOf(serialNoInput) === -1) {
          displayRow = false;
        }

        if (dateCheckbox) {
          if (dateFromInput) {
            const [dayFrom, monthFrom, yearFrom] = dateFromInput.split('-');
            const dateFrom = new Date(`${yearFrom}-${monthFrom}-${dayFrom}`);
            if (ndate < dateFrom) {
              displayRow = false;
            }
          }

          if (dateToInput) {
            const [dayTo, monthTo, yearTo] = dateToInput.split('-');
            const dateTo = new Date(`${yearTo}-${monthTo}-${dayTo}`);
            if (ndate > dateTo) {
              displayRow = false;
            }
          }
        }

        tr[i].style.display = displayRow ? "" : "none";
      }
    }
  }

  function toggleInput(...inputIds) {
    inputIds.forEach(id => {
      const input = document.getElementById(id);
      input.disabled = !input.disabled;
      if (input.disabled) {
        input.value = '';
      }
    });
  }
</script>

{% endblock %}
