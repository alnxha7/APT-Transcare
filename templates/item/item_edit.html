{% extends "base.html" %}
{% load static %}
{% block content %}

   <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
 
<style>
     body {
            font-family: Public Sans, sans-serif;
            background-color: #f4f4f4;

            margin: 0;
            padding: 0;
            font-size: 12px;
            /*font-weight: 100;*/
            align-items: center;
            color:black;

        }
         .logo p {
        color:white;
        }
        .container_box {
            /*background:#f5f5f5;*/
            background-color:antiquewhite;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            /*width: 50%;*/
           /* border: 2px solid rgb(43, 114, 227);*/
            margin:auto;
            margin-top:20px;
            height: 85vh;
            overflow: hidden;
            overflow-y: scroll;
            margin:40px auto;
            width: 70%;
        }


        h2 {
            text-align: center;
            margin-bottom: 20px;
        }

        label {

            margin-bottom: 5px;
            /*font-weight: bold;*/
        }

        
        input, select {
            width: 100%;
           /* padding: 8px;*/
            margin-bottom: 3px;
            border: 1px solid #ced4da;
            height:20px;
            /*border-radius: 5px;*/
            font-size: 12px;
        }
        select {
        padding:3px;
        background:white;

        }
        table {
            background:white;
            border-collapse: collapse;
            margin-top: 20px;
            margin-bottom:20px;
        
        }
        .table_input{
            border:none;
            margin-bottom: 0px;;
        }
        th {
            /*border: 1px solid black;*/
            background:#f2f2f2;
           /* padding:5px;*/
            text-align: center;
        }
        td {
           /*border: 1px solid black;*/
           background:white;
        }
        button {

            padding: 10px;
            background: #28a745;
            border: none;
            color: white;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
        }

        button:hover {
            background: #218838;
        }
        .btn {
            margin-top: 10px;
            display: inline-block;
            padding: 8px 15px;
            text-decoration: none;
            border-radius: 4px;
            color: white;
            margin-right:10px;
            margin-bottom:20px;
        }
        #tripTable {
            border:1px solid #ced4da;
            border-collapse: collapse;
        }
        #tripTable th, #tripTable td {
            border: 1px solid #ced4da;
        }
        .save-btn { background-color: #28a745; }
        .back-btn { background-color: #007bff; }

        .input-right {
            text-align: right;
        }
    @media only screen and (max-width: 600px) {
  .container_box  {
    width: 90%;
  }
}
</style>
 <div class="container_box">

{% if messages %}
  {% for message in messages %}
    <p style="color:red;">{{ message }}</p>
  {% endfor %}
{% endif %}

<form method="post">
     {% csrf_token %}
   




<div class="container mt-4">
    <h3 class="text-center">Item Master</h3>
   

    <div class="row mb-3">
        <div class="col-md-12 d-flex align-items-center">
            <label for="name" class="form-label me-2 mb-0" style="width: 120px;">ITEM Name</label>
            <input type="text" class="form-control p-1" name="name" value="{{ item.name|default:'' }}" style="font-weight: bold; background-color: #90EE90; color: black;" readonly>
        </div>
            {% if name_error %}
            <small class="text-danger">{{ name_error }}</small>
            {% endif %}
    </div>

    
    {% comment %} <div class="row mb-3">
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 150px;">Batch No</label>
            <input type="text" class="form-control p-1" name="batch_no" value="{{ stock.batch_no}}" style="font-weight: bold;" readonly>
        </div>

        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 100px;">Exp date</label>
            <input type="date" class="form-control p-1" name="exp_date" value="{{ stock.exp_date|date:'Y-m-d'  }}" style="font-weight: bold;" readonly>
        </div>
    </div> {% endcomment %}

    <div class="row mb-3">
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 150px;">HSN Code</label>
            <input type="text" class="form-control p-1" name="hsn" value="{{ item.hsn}}" style="font-weight: bold;" readonly>
        </div>

        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 100px;">Stock</label>
            <input type="number" class="form-control p-1" name="stock" value="{{ stock.stock|default:'' }}" style="font-weight: bold; background-color: #c0ebf1;" readonly>
        </div>
    </div>

     <div class="row mb-3">
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 150px;">Unit</label>
            <select name="unit" required disabled>
            <option value="">-- Select Unit --</option>
            {% for unit in units %}
            <option value="{{ unit.pk }}" {% if item.unit_id == unit.pk %}selected{% endif %}>{{ unit.unit }}</option>
            {% endfor %}
            </select>
            <!-- <input type="text" class="form-control p-1" name="unit" value="{{ item.unit}}" style="font-weight: bold;"> -->
        </div>

        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 100px;">Group</label>
               <select name="group" required id="group" class="form-select" disabled>
                    <option value="">-- Select group --</option>
                    {% for group in groups %}
                        <option value="{{ group.pk }}" {% if item.group_id == group.pk %}selected{% endif %}>{{ group.item_group }}</option>
                    {% endfor %}
                </select>
            <!-- <input type="text" class="form-control p-1" name="group" value="{{ item.group|default:'' }}" style="font-weight: bold;"> -->
        </div>
    </div>

     <div class="row mb-3">
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 150px;">P.Price</label>
            <input type="number" class="form-control p-1" name="p_price" value="{{ stock.p_price}}" style="font-weight: bold;" readonly>
        </div>

        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 100px;">Sub Group</label>
            <input type="text" class="form-control p-1" name="sub_group" id="sub_group" value="{{ item.sub_group|default:'' }}" style="font-weight: bold;" readonly>
        </div>
    </div>

  

    <div class="row mb-3">
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 150px;">Price 1</label>
            <input type="number" class="form-control p-1" name="price_1" value="{{ stock.price_1}}" style="font-weight: bold;" readonly>
        </div>

        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 100px;">Op.Stock</label>
            <input type="number" class="form-control p-1" name="op_stock" value="{{ stock.op_stock }}" style="font-weight: bold;" readonly>
        </div>
    </div>

    <div class="row mb-3">
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 150px;">Price 2</label>
            <input type="number" class="form-control p-1" name="price_2" value="{{ stock.price_2}}" style="font-weight: bold;" readonly>
        </div>

        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 100px;">Op.lc</label>
            <input type="number" class="form-control p-1" name="op_lc" value="{{ stock.op_lc }}" style="font-weight: bold;" readonly>
        </div>
    </div>

    <div class="row mb-3">
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 150px;">Price 3</label>
            <input type="number" class="form-control p-1" name="price_3" value="{{stock.price_3}}" style="font-weight: bold;" readonly>
        </div>
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 100px;">Max.level</label>
            <input type="number" class="form-control p-1" name="max_level" value="{{item.max_level}}" style="font-weight: bold;" readonly>
        </div>
    </div>

    <div class="row mb-3">
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 150px;">MRP</label>
            <input type="number" class="form-control p-1" name="mrp" value="{{stock.mrp}}" style="font-weight: bold;" readonly>
        </div>
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 100px;">Reorder</label>
            <input type="number" class="form-control p-1" name="reorder" value="{{item.reorder}}" style="font-weight: bold;" readonly>
        </div>
    </div>

    <div class="row mb-3">
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 150px;">GST %</label>
             <select name="gst" required disabled>
                <option value="">-- Select gst --</option>
                {% for gst in gsts %}
                    <option value="{{ gst.pk }}" {% if stock.gst_id == gst.pk %}selected{% endif %}>{{ gst.tax_perc }}</option>
                {% endfor %}
            </select>
            <!-- <input type="number" class="form-control p-1" name="gst" value="{{item.gst}}" style="font-weight: bold;"> -->
        </div>
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 100px;">Min.level</label>
            <input type="number" class="form-control p-1" name="min_level" value="{{item.min_level}}" style="font-weight: bold;" readonly>
        </div>
    </div>

    <div class="row mb-3">
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 150px;">Godown</label>
            <input type="text" class="form-control p-1" name="godown" value="{{item.godown}}" style="font-weight: bold;" readonly>
        </div>
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 100px;">Location</label>
            <input type="text" class="form-control p-1" name="location" value="{{item.location}}" style="font-weight: bold;" readonly>
        </div>
    </div>

      <div class="row mb-3">
        <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 150px;">Land.Cost</label>
            <input type="number" class="form-control p-1" name="land_coast" value="{{ stock.land_coast}}" style="font-weight: bold;" readonly>
        </div>

        <!-- <div class="col-md-6 d-flex align-items-center">
            <label class="form-label me-2 mb-0" style="width: 100px;">Supplier</label>
            <input type="number" class="form-control p-1" name="supplier" value="{{ item.supplier|default:'' }}" style="font-weight: bold;">
        </div> -->
    </div>

    <div class="row mb-3">
        <div class="col-md-12 d-flex align-items-center">
            <label for="name" class="form-label me-2 mb-0" style="width: 120px;">Description</label>
            <input type="text" class="form-control p-1" name="description" value="{{ item.description|default:'' }}" style="font-weight: bold;" readonly>
        </div>
    </div>


</div>





             {% if item.pk %}
            <a href="{% url 'main:item_delete' item.pk %}" class="btn back-btn delete-btn" >Delete</a>
            {% endif %}
            
            <a href="{% url 'main:item_update' item.pk %}" class="btn back-btn">Update</a>
            <a href="{% url 'main:index' %}" class="btn back-btn">Back</a>
            <a href="{% url 'main:item_list'%}" class="btn back-btn">List</a>

     
 
</form>

<!-- </div> -->
</div>
<script>
    //script for deletion
document.addEventListener('DOMContentLoaded', function () {
    const deleteBtn = document.querySelector('.delete-btn');

    if (deleteBtn) {
        deleteBtn.addEventListener('click', function (e) {
            e.preventDefault();  // Prevent immediate navigation

            Swal.fire({
                title: "Are you sure?",
                text: "This action cannot be undone!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#3085d6",
                cancelButtonColor: "#d33",
                confirmButtonText: "Yes, delete it!"
            }).then((result) => {
                if (result.isConfirmed) {
                    // Show success message then redirect
                    Swal.fire({
                        title: "Deleted!",
                        text: "Resident record will be deleted.",
                        icon: "success",
                        timer: 1500,
                        showConfirmButton: false
                    });

                    // Delay a little so success message can be seen
                    setTimeout(() => {
                        window.location.href = deleteBtn.href;
                    }, 1600);
                }
            });
        });
    }
});
</script>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const groupSelect = document.getElementById('group-select');
        const subGroupInput = document.getElementById('sub_group');

        if (!groupSelect || !subGroupInput) {
            console.error('Missing element(s): group-select or sub_group');
            return;
        }

        groupSelect.addEventListener('change', function () {
            const selectedOption = this.options[this.selectedIndex];
            const subgroupValue = selectedOption.getAttribute('data-subgroup') || '';
            subGroupInput.value = subgroupValue;
        });
    });
</script>







{% endblock %}